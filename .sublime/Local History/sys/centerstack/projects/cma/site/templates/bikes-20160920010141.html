<!--======================
 *  Author:		Dave Luke Jr
 *  Company:	CenterStack.io
 *  Description:	bikes.html
 *======================-->
{% extends "base.html" %}
{% load widget_tweaks %}
{% load humanize %}
{% load mathfilters %}
{% load staticfiles %}
{% block content_site %}


<!--	Bike Table
========================================= -->
<div class="pi-row">
	<div class="pi-col-md-12">
		<div class="portlet light portlet-fit ">

			<!--	Top Toolbar
			========================================= -->
			<div class="portlet-title">
				<div class="caption">
					<i class="pe-7s-bicycle"> </i>
					<span class="caption-subject base-font"> Bikes </span>
				</div>
			</div>
			<div class="portlet-body">

				<!--	Table Toolbar
				========================================= -->
				<div class="table-toolbar">
					<div class="pi-row">
						<div class="pi-col-md-6">
							<div id="datatable-btn" class="actions">
								<a class="btn base" href="{% url 'bike_new' %}"> New </a>
								<label class="btn base m-b-0" for="checkbox-input"> Delete </label>
							</div>
						</div>
						<div class="pi-col-md-6">
							<div id="datatable-btn-export" class="pull-right"></div>
						</div>
					</div>
				</div>

				<!--	Table
				========================================= -->
				<form action="{% url 'bike_delete' %}" method="post">
					{% csrf_token %}
					<table class="table table-striped table-bordered table-hover table-checkable order-column" id="cs_datatable">
						<thead>

							<!--	Table Column Names
							========================================= -->
							<tr>
								<th><input class="group-checkable" data-set="#cs_datatable .checkboxes" type="checkbox"></th>
								<th> ID </th>
								<th> Bike </th>
								<th> Status </th>
								<th> License Plate </th>
								<th> VIN </th>
								<th> Color </th>
								<th> Year </th>
								<th> mileage </th>
								<th> Purchase Price </th>
								<th> Rental Price </th>
							</tr>
						</thead>
						<tbody>

						<!--	Table Data
						========================================= -->
						{% for bike in bikes %}
							<tr class="odd gradeX">
								<td><input type="checkbox" class="checkboxes" name="checked" value="{{ bike.pk }}"></td>
								<td>{{ bike.pk }}</td>
								<td><a href="/bikes/edit/{{ bike.pk }}">{{ bike.name }}</a></td>

								{% if bike.status = "Rented" %}
									<td><span class="label label-danger">{{ bike.status }}</span></td>
								{% else %}
									<td><span class="label label-pending-deposit">{{ bike.status }}</span></td>
								{% endif %}

								<td>{{ bike.license_plate }}</td>
								<td>{{ bike.vin }}</td>
								<td>{{ bike.color }}</td>
								<td>{{ bike.year }}</td>
								<td>{{ bike.current_mileage|intcomma}}</td>
								<td>${{ bike.purchase_price|intcomma }}</td>
								<td>${{ bike.rental_price }}</td>
							</tr>
						{% endfor %}

						</tbody>
					</table>
					<input type="submit" class="hidden" id="checkbox-input">
				</form>
			</div>
		</div>
	</div>
</div>




<!--	Bar Chart
========================================= -->
<div class="pi-row">
	<div class="pi-col-md-8">
		<div class="portlet light portlet-fit ">
			<div class="portlet-title">
				<div class="caption">
					<i class="pe-7s-bicycle"> </i>
					<span class="caption-subject base-font"> Bike Mileages </span>
				</div>
			</div>
			<div class="portlet-body">
				<div id="mileage_graph" style="width: 100%; height: 200px;"></div>
			</div>
		</div>
	</div>


	<!--	Pie Chart
	========================================= -->
	<div class="pi-col-md-4">
		<div class="portlet light portlet-fit ">
			<div class="portlet-title">
				<div class="caption">
					<i class="pe-7s-bicycle"> </i>
					<span class="caption-subject base-font"> Current Utilization </span>
				</div>
			</div>
			<div class="portlet-body">
				<div id="pie_graph2" style="width: 100%; height: 200px;"></div>
			</div>
		</div>
	</div>
</div>


<!--	Printing in Landscape
========================================= -->
<style type="text/css" media="print">
	@page { size: landscape; }
	table { writing-mode: tb-rl; }
</style>


<!--	Javascript
========================================= -->
<script>
	$(function() {
		
		/*	Checkbox Delete
		========================================= */
		var table = $('#cs_datatable');
		table.dataTable({
			"language": {
				"aria": {
					"sortAscending": ": activate to sort column ascending",
					"sortDescending": ": activate to sort column descending"
				},
				"emptyTable": "No data available in table",
				"info": "Showing _START_ to _END_ of _TOTAL_ records",
				"infoEmpty": "No Records Found",
					"infoFiltered": "(filtered1 from _MAX_ total records)",
				"lengthMenu": "Show _MENU_",
				"search": "Search:",
				"zeroRecords": "No Matching Records Found",
				"paginate": {
					"previous":"Prev",
					"next": "Next",
					"last": "Last",
					"first": "First"
				}
			},
			"bStateSave": true,
			"lengthMenu": [
				[5, 10, 15, 20, -1],
				[5, 10, 15, 20, "All"]
			],
			"pageLength": 15,
			"pagingType": "bootstrap_full_number",
			"order": [ [2, "asc"] ],
			"columnDefs": [ {
				"targets": 0,
				"orderable": false,
				"searchable": false
			}],
		});


		/*	Buttons
		========================================= */
		var datatable = $('#cs_datatable').DataTable();
		new $.fn.dataTable.Buttons( datatable, {
			 buttons: [
				  'print', 'pdf', 'excel'
			 ]
		} );
		datatable.buttons( 0, null ).containers().appendTo( '#datatable-btn-export' );


		/*	Adding Checked Values
		========================================= */
		
		var table = $('#cs_datatable').dataTable();
		table.find('.group-checkable').change(function () {
			var set = jQuery(this).attr("data-set");
			var checked = jQuery(this).is(":checked");
			jQuery(set).each(function () {
				if (checked) {
					$(this).prop("checked", true);
					$(this).parents('tr').addClass("active");

				} else {
					$(this).prop("checked", false);
					$(this).parents('tr').removeClass("active");
				}
			});
			jQuery.uniform.update(set);
		});
		table.on('change', 'tbody tr .checkboxes', function () {
			var $input = $(this);
			$(this).parents('tr').toggleClass("active");
		});
	});
</script>


{% endblock %}